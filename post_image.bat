@echo off

chcp 65001 >nul
cls

openfiles >nul 2>&1
if %errorlevel% neq 0 (
echo [X] ERROR: Administrative privileges are required.
echo Please right-click this script and select "Run as administrator".
echo.
pause
exit /b
)

title Device functionallity verification

echo Check updates and Driver Updates

echo Starting powershell

start powershell -ExecutionPolicy RemoteSigned -encodedcommand dAByAHkAIAB7AA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEkAbgBzAHQAYQBsAGwAaQBuAGcAIABOAHUARwBlAHQAIgAgAC0ARgBvAHIAZQBnAHIAbwB1AG4AZABDAG8AbABvAHIAIABCAGwAdQBlAA0ACgAgACAAIAAgAEkAbgBzAHQAYQBsAGwALQBQAGEAYwBrAGEAZwBlAFAAcgBvAHYAaQBkAGUAcgAgAC0ATgBhAG0AZQAgAE4AdQBHAGUAdAAgAC0ATQBpAG4AaQBtAHUAbQBWAGUAcgBzAGkAbwBuACAAMgAuADgALgA1AC4AMAAyADEAIAAtAEYAbwByAGMAZQANAAoAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgBJAG4AcwB0AGEAbABsAGkAbgBnACAAUABzAFcAaQBuAGQAbwB3AHMAVQBwAGQAYQB0AGUAIgAgAC0ARgBvAHIAZQBnAHIAbwB1AG4AZABDAG8AbABvAHIAIABCAGwAdQBlAA0ACgAgACAAIAAgAEkAbgBzAHQAYQBsAGwALQBNAG8AZAB1AGwAZQAgAC0ATgBhAG0AZQAgAFAAUwBXAGkAbgBkAG8AdwBzAFUAcABkAGEAdABlACAALQBGAG8AcgBjAGUADQAKACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIASQBtAHAAbwByAHQAaQBuAGcAIABNAG8AZAB1AGwAZQAiACAALQBGAG8AcgBlAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgAgAEIAbAB1AGUADQAKACAAIAAgACAASQBtAHAAbwByAHQALQBNAG8AZAB1AGwAZQAgAC0ATgBhAG0AZQAgAFAAUwBXAGkAbgBkAG8AdwBzAFUAcABkAGEAdABlACAALQBGAG8AcgBjAGUAIAAgACAAIAANAAoAIAAgACAAIAANAAoAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAIgBBAGQAZAAgAHcAaQBuAGQAbwB3AHMAIABzAGUAcgB2AGkAYwBlACIAIAAtAEYAbwByAGUAZwByAG8AdQBuAGQAQwBvAGwAbwByACAAQgBsAHUAZQANAAoAIAAgACAAIABBAGQAZAAtAFcAVQBTAGUAcgB2AGkAYwBlAE0AYQBuAGEAZwBlAHIAIAAtAFMAZQByAHYAaQBjAGUASQBEACAAIgA3ADkANwAxAGYAOQAxADgALQBhADgANAA3AC0ANAA0ADMAMAAtADkAMgA3ADkALQA0AGEANQAyAGQAMQBlAGYAZQAxADgAZAAiACAALQBDAG8AbgBmAGkAcgBtADoAJABmAGEAbABzAGUADQAKACAAIAAgACAADQAKACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIARwBlAHQAIAB3AGkAbgBkAG8AdwBzACAAdQBwAGQAYQB0AGUAIgAgAC0ARgBvAHIAZQBnAHIAbwB1AG4AZABDAG8AbABvAHIAIABCAGwAdQBlAA0ACgAgACAAIAAgAEcAZQB0AC0AVwBpAG4AZABvAHcAcwBVAHAAZABhAHQAZQANAAoADQAKACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIASQBuAHMAdABhAGwAbAAgAHcAaQBuAGQAbwB3AHMAIAB1AHAAZABhAHQAZQAiACAALQBGAG8AcgBlAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgAgAEIAbAB1AGUADQAKACAAIAAgACAASQBuAHMAdABhAGwAbAAtAFcAaQBuAGQAbwB3AHMAVQBwAGQAYQB0AGUAIAAtAEkAbgBzAHQAYQBsAGwAIAAtAEEAYwBjAGUAcAB0AEEAbABsACAADQAKACAAIAAgACAADQAKACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIASQBuAHMAdABhAGwAbAAgAGEAbABsACAAZAByAGkAdgBlAHIAIAB1AHAAZABhAHQAZQBzACIAIAAtAEYAbwByAGUAZwByAG8AdQBuAGQAQwBvAGwAbwByACAAQgBsAHUAZQANAAoAIAAgACAAIABJAG4AcwB0AGEAbABsAC0AVwBpAG4AZABvAHcAcwBVAHAAZABhAHQAZQAgAC0ASQBuAHMAdABhAGwAbAAgAC0AQQBjAGMAZQBwAHQAQQBsAGwAIAAtAFUAcABkAGEAdABlAFQAeQBwAGUAIABEAHIAaQB2AGUAcgAgAC0ATQBpAGMAcgBvAHMAbwBmAHQAVQBwAGQAYQB0AGUAIAAtAEYAbwByAGMAZQBEAG8AdwBuAGwAbwBhAGQAIAAtAEYAbwByAGMAZQBJAG4AcwB0AGEAbABsACAALQBJAGcAbgBvAHIAZQBSAGUAYgBvAG8AdAAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQAgAA0ACgAgACAAIAAgAEkAbgBzAHQAYQBsAGwALQBXAGkAbgBkAG8AdwBzAFUAcABkAGEAdABlACAALQBJAG4AcwB0AGEAbABsACAALQBBAGMAYwBlAHAAdABBAGwAbAAgAC0AVQBwAGQAYQB0AGUAVAB5AHAAZQAgAEQAcgBpAHYAZQByACAALQBNAGkAYwByAG8AcwBvAGYAdABVAHAAZABhAHQAZQAgAC0ARgBvAHIAYwBlAEQAbwB3AG4AbABvAGEAZAAgAC0ARgBvAHIAYwBlAEkAbgBzAHQAYQBsAGwAIAAtAEkAZwBuAG8AcgBlAFIAZQBiAG8AbwB0ACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlAA0ACgB9AA0ACgBjAGEAdABjAGgAIAB7AA0ACgAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEUAcgByAG8AcgA6ACAAJAAoACQAXwAuAEUAeABjAGUAcAB0AGkAbwBuAC4ATQBlAHMAcwBhAGcAZQApACIAIAAtAEYAbwByAGUAZwByAG8AdQBuAGQAQwBvAGwAbwByACAAUgBlAGQADQAKAH0A


echo - Trying Dell device
set "dcu_path=C:\Program Files\Dell\CommandUpdate\DellCommandUpdate.exe"
if not exist "%dcu_path%" set "dcu_path=C:\Program Files (x86)\Dell\CommandUpdate\DellCommandUpdate.exe"

if exist "%dcu_path%" (
echo [+] Launching Dell Command Update GUI...
start "" "%dcu_path%"
echo.
echo Please check for updates in the application before proceeding.
) else (
echo [!] Dell Command Update GUI not found attempting Lenovo.
goto noDell
)

:noDell
echo - Lenovo device attempt.
echo - TODO OPEN VANTAGE

Azure AD Join Status.

:checkAzureStatusLoop
echo - Checking Azure AD join status...

set "azureStatus=NO"
dsregcmd /status | findstr /C:"AzureAdJoined" | findstr /C:"YES" >nul
if %errorlevel% equ 0 set "azureStatus=YES"

if /I "%azureStatus%"=="YES" (
echo [+] SUCCESS: Device is joined to Azure AD.
goto openWord
)

echo [!] NOTICE: Device is NOT joined to Azure AD.
echo.
echo - Attempting to join now...
dsregcmd /join
echo.
echo --- Waiting 30 seconds before checking the status again...
timeout /t 30 /nobreak >nul
echo.

goto checkAzureStatusLoop

goto openWord

:openWord

echo Opening Microsoft Word

start winword.exe

if %errorlevel% neq 0 (
echo [!] Could not launch Word automatically.
echo Please manually open Word to verify Office is installed.
) else (
echo [+] Word launched successfully.
)
echo.

echo - Opening Windows Update settings...
start ms-settings:windowsupdate
start microsoft.windows.camera:

echo All tasks are finished.

echo Press Enter to close apps...
pause

taskkill /IM winword.exe /F
taskkill /F /IM WindowsCamera.exe /T

exit
